<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conquestadors</title>
    <link rel="stylesheet" href="style.css?v=glass">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>

<body>
    <!-- Game Canvas (Background) -->
    <canvas id="game-canvas"></canvas>

    <!-- Setup Screen -->
    <div id="setup-screen" class="setup-overlay">
        <div style="position: absolute; top: 1rem; left: 2rem; z-index: 2001;">
            <a href="../../index.html#experiments" class="back-link glass-btn" style="margin-top: 12px;"><i
                    class="fas fa-arrow-left"></i> Portfolio</a>
        </div>
        <div class="setup-card glass">
            <h2>Conquestadors</h2>
            <p>Turn-based strategy game<br />
                Inspired by <a href="https://www.windowsgames.co.uk/slay.html" style="color: white;">Sean O'Connor's
                    Slay</a><br />
                Divide and conquer to protect the island from the conquistadors</p>

            <div class="setup-tabs">
                <button class="setup-tab active" data-target="quickplay">
                    <i class="fas fa-play"></i> Quick Play
                </button>
                <button class="setup-tab" data-target="campaign">
                    <i class="fas fa-flag"></i> Campaign
                </button>
            </div>

            <!-- TAB: QUICK PLAY -->
            <div id="tab-quickplay" class="setup-panel active">
                <div class="setup-form">
                    <div class="form-group">
                        <label>Human Players</label>
                        <div class="player-count-select">
                            <button class="count-btn active" data-humans="1">1</button>
                            <button class="count-btn" data-humans="2">2</button>
                            <button class="count-btn" data-humans="3">3</button>
                            <button class="count-btn" data-humans="4">4</button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Total Players (Humans + AI)</label>
                        <div class="player-count-select">
                            <button class="total-btn" data-total="2">2</button>
                            <button class="total-btn" data-total="3">3</button>
                            <button class="total-btn" data-total="4">4</button>
                            <button class="total-btn" data-total="5">5</button>
                            <button class="total-btn active" data-total="6">6</button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>AI Level</label>
                        <div class="toggle-group" id="ai-level-group">
                            <button class="toggle-btn ai-btn" data-level="1" title="Easy (Random)">
                                <img src="assets/shop_peasant.png" class="icon-sm">
                            </button>
                            <button class="toggle-btn ai-btn active" data-level="2" title="Normal">
                                <img src="assets/shop_spearman.png" class="icon-sm">
                            </button>
                            <button class="toggle-btn ai-btn" data-level="3" title="Hard (Strategic)">
                                <img src="assets/shop_knight.png" class="icon-sm">
                            </button>
                            <button class="toggle-btn ai-btn" data-level="4" title="Expert (Perfect)">
                                <img src="assets/shop_baron.png" class="icon-sm">
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Map Type</label>
                        <button id="select-map-btn" class="secondary-btn wide">
                            <i class="fas fa-dice"></i> <span id="selected-map-name">Random</span>
                        </button>
                        <input type="hidden" id="selected-map-id" value="random">
                    </div>

                    <div id="map-size-group" class="form-group">
                        <label>Map Size <span id="map-size-display" style="float: right; color: var(--color-muted);">100
                                Hexes</span></label>
                        <input type="range" id="map-size-slider" min="50" max="500" value="100" step="10"
                            style="width: 100%; accent-color: var(--color-accent);">
                    </div>

                    <button id="start-game-btn" class="primary-btn wide pulse">Start Conquest</button>
                </div>
            </div>

            <!-- TAB: CAMPAIGN -->
            <div id="tab-campaign" class="setup-panel">
                <div id="campaign-level-grid" class="campaign-grid">
                    <!-- Populated by JS -->
                </div>
                <button id="start-campaign-btn" class="primary-btn wide pulse" style="margin-top: 1rem;">Start
                    Conquest</button>
                <div style="text-align: center; margin-top: 0.5rem;">
                    <button id="clear-history-btn" class="text-btn discrete"
                        style="font-size: 0.8rem; opacity: 0.6;">Clear History</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Map Selection Modal -->
    <div id="map-modal" class="modal glass hidden">
        <div class="modal-content map-modal-content">
            <span class="close-modal" id="close-map-modal">&times;</span>
            <h2>Select Map</h2>
            <div class="map-grid" id="map-list">
                <!-- Populated by JS -->
            </div>
        </div>
    </div>

    <!-- Main Game UI (Initially Hidden) -->
    <div id="game-ui" class="hidden">
        <header>
            <div class="header-left">
                <button id="quit-btn" class="secondary-btn" title="Quit to Menu"><i class="fas fa-sign-out-alt"></i>
                    Quit</button>
            </div>
            <div class="header-center">
                <h1>Conquestadors</h1>
            </div>
            <div class="header-right">

                <button id="help-btn" class="secondary-btn"><i class="fas fa-question-circle"></i> Help</button>
                <button id="recenter-btn" class="secondary-btn" title="Recenter Map"><i
                        class="fas fa-crosshairs"></i></button>
                <button id="end-turn-btn" class="primary-btn">End Turn <i class="fas fa-forward"></i></button>
            </div>
        </header>

        <div id="help-modal" class="modal glass hidden">
            <div class="modal-content">
                <span class="close-modal">&times;</span>
                <h2>How to Play Conquestadors</h2>
                <div class="help-scroll">
                    <h3>Objective</h3>
                    <p>Capture the whole island by killing all enemy units and capturing their land.</p>

                    <h3>Action Indicators</h3>
                    <ul>
                        <li><span style="color:red; font-weight:bold;">●</span> <strong>Red Dot (Unit):</strong> This
                            unit is ready to act.</li>
                        <li><span style="color:red; font-weight:bold;">●</span> <strong>Red Dot (Capital):</strong>
                            Treasury has enough money to buy units or castles.</li>
                    </ul>

                    <h3>Movement & Combat</h3>
                    <ul>
                        <li><strong>Movement:</strong> You can move a unit <strong>infinitely</strong> within its own
                            territory.</li>
                        <li><strong>Combat:</strong> Moving to an adjacent enemy tile or a tree consumes the unit's
                            action for the turn.</li>
                        <li><strong>Defense:</strong> A tile is defended by its occupant and all neighbors in the
                            <strong>same territory</strong>.
                        </li>
                        <li><strong>Strength:</strong> Peasant(1), Spearman(2), Knight(3), Baron(4). Castles defend with
                            strength 2.</li>
                    </ul>

                    <h3>Economics</h3>
                    <ul>
                        <li><strong>Income:</strong> +1 credit per hexagon (without trees).</li>
                        <li><strong>Wages:</strong> Peasant(2), Spearman(6), Knight(18), Baron(54).</li>
                        <li><strong>Bankruptcy:</strong> If wages exceed money at turn start, all units die and become
                            trees!</li>
                    </ul>

                    <h3>Merging</h3>
                    <p>Combine two units to create a stronger one (e.g., Peasant + Peasant = Spearman). Be careful of
                        the higher wages!</p>
                </div>
            </div>
        </div>
        <div id="game-over-modal" class="modal glass hidden">
            <div class="modal-content game-over-content">
                <h2 id="winner-announce">Winner!</h2>
                <div class="stats-grid" id="game-over-stats"></div>
                <button id="restart-btn" class="primary-btn wide">Play Again <i class="fas fa-redo"></i></button>
            </div>
        </div>
        <main class="game-container">


            <aside class="sidebar glass">
                <div class="sidebar-section player-list" id="player-status-panel">
                    <h3>Leaderboard</h3>
                    <div id="players-container" class="players-container">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <div class="sidebar-section territory-info">
                    <h3>Territory Info</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="label">Land</span>
                            <span id="stat-land" class="value">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="label">Income</span>
                            <span id="stat-income" class="value">+0</span>
                        </div>
                        <div class="stat-item">
                            <span class="label">Wages</span>
                            <span id="stat-wages" class="value">-0</span>
                        </div>
                        <div class="stat-item">
                            <span class="label">Balance</span>
                            <span id="stat-balance" class="value">0</span>
                        </div>
                    </div>
                </div>

                <div class="sidebar-section shop" id="shop-container">
                    <h3>Unit Shop</h3>
                    <div class="shop-grid">
                        <button class="shop-item" data-unit="peasant">
                            <img src="assets/shop_peasant.png" class="shop-unit-icon" alt="Peasant">
                            <span>10<img src="assets/coin.png" class="coin-icon" alt="c"></span>
                        </button>
                        <button class="shop-item" data-unit="spearman">
                            <img src="assets/shop_spearman.png" class="shop-unit-icon" alt="Spearman">
                            <span>20<img src="assets/coin.png" class="coin-icon" alt="c"></span>
                        </button>
                        <button class="shop-item" data-unit="knight">
                            <img src="assets/shop_knight.png" class="shop-unit-icon" alt="Knight">
                            <span>30<img src="assets/coin.png" class="coin-icon" alt="c"></span>
                        </button>
                        <button class="shop-item" data-unit="baron">
                            <img src="assets/shop_baron.png" class="shop-unit-icon" alt="Baron">
                            <span>40<img src="assets/coin.png" class="coin-icon" alt="c"></span>
                        </button>
                        <button class="shop-item" data-unit="castle">
                            <img src="assets/shop_castle.png" class="shop-unit-icon" alt="Castle">
                            <span>15<img src="assets/coin.png" class="coin-icon" alt="c"></span>
                        </button>

                    </div>
                </div>

                <div class="sidebar-section history">
                    <h3>Event Log</h3>
                    <div id="event-log" class="event-log">
                        <p class="log-entry system">Island initialized. Prepare for glory.</p>
                    </div>
                </div>
            </aside>
        </main>
    </div>
    <div id="game-over-modal" class="modal glass hidden">
        <div class="modal-content text-center">
            <h2 id="winner-announce" class="winner-title">Winner!</h2>
            <div id="game-over-stats" class="stats-grid"></div>
            <button id="restart-btn" class="primary-btn wide">Play Again</button>
        </div>
    </div>

    <div id="cursor-follower" class="cursor-follower" style="display:none;"></div>
    <div id="shop-tooltip" class="shop-tooltip hidden"></div>

    <script src="maps/earth.js"></script>
    <script src="maps/cuba.js"></script>
    <script src="maps/hispaniola.js"></script>
    <script src="maps/japan.js"></script>
    <script src="maps/great_britain.js"></script>
    <script src="maps/corsica.js"></script>
    <script src="maps/guadeloupe.js"></script>
    <div id="turn-toast" class="toast hidden">It's your turn!</div>

    <script src="script.js"></script>
</body>

</html>